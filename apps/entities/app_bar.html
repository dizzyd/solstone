<style>
.entity-add-input {
  flex: 1;
  min-width: 0;
  padding: 0.75em 1em;
  border: 1px solid #d1d5db;
  border-radius: 20px;
  font-family: inherit;
  font-size: 14px;
  line-height: 1.5;
  transition: border-color 0.15s, box-shadow 0.15s;
}

.entity-add-input:focus {
  outline: none;
  border-color: var(--facet-color, #667eea);
  box-shadow: 0 0 0 3px var(--facet-bg, rgba(102, 126, 234, 0.1));
}

.entity-add-input::placeholder {
  color: #9ca3af;
}

.entity-add-input:disabled {
  background: #f3f4f6;
  color: #9ca3af;
  cursor: not-allowed;
  opacity: 0.7;
}

.entity-add-input:disabled::placeholder {
  color: #d1d5db;
}
</style>

<form id="entity-add-form" style="display: contents;">
  <input
    type="text"
    id="entity-assist-input"
    class="entity-add-input"
    placeholder="Add entity with AI (e.g., 'OpenAI', 'Claude')..."
    autocomplete="off"
  >
</form>

<script>
(function() {
  const input = document.getElementById('entity-assist-input');
  if (!input) return;

  // Check if facet is selected and update input state
  function updateInputState() {
    const facet = window.selectedFacet;
    if (!facet) {
      input.disabled = true;
      input.placeholder = 'Select a facet to add entities';
    } else {
      input.disabled = false;
      input.placeholder = "Add entity with AI (e.g., 'OpenAI', 'Claude')...";
    }
  }

  // Initial state - wait for DOM to ensure window.selectedFacet is set
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', updateInputState);
  } else {
    updateInputState();
  }

  // Listen for facet changes
  window.addEventListener('facet.switch', updateInputState);

  // Focus input if nothing else is focused
  setTimeout(() => {
    if (document.activeElement === document.body && !input.disabled) {
      input.focus();
    }
  }, 100);
})();
</script>
