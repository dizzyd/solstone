<style>
.dev-facet-display {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background: #f9fafb;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  font-size: 14px;
}

.dev-facet-display.has-facet {
  background: var(--facet-bg, #f9fafb);
  border-color: var(--facet-color, #e5e7eb);
}

.dev-facet-display strong {
  font-weight: 500;
  color: #6b7280;
}

.dev-facet-display small {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: #9ca3af;
  margin-left: 4px;
}

.dev-facet-all {
  color: #667eea;
  font-weight: 600;
}
</style>

<div class="dev-facet-display{% if selected_facet %} has-facet{% endif %}" id="dev-facet-display">
  <strong>Facet:</strong>
  <span id="dev-facet-value">
    {% if selected_facet %}
      {% set selected_facet_data = facets|selectattr("name", "equalto", selected_facet)|first %}
      {% if selected_facet_data %}
        {{ selected_facet_data.emoji }} {{ selected_facet_data.title }}
        <small>specific</small>
      {% else %}
        {{ selected_facet }}
        <small>specific</small>
      {% endif %}
    {% else %}
      <strong class="dev-facet-all">All Facets</strong>
      <small>all-facet</small>
    {% endif %}
  </span>
</div>

<script>
(function() {
  // Listen for facet.switch events
  window.addEventListener('facet.switch', (e) => {
    updateFacetDisplay(e.detail.facet, e.detail.facetData);
  });

  function updateFacetDisplay(facetName, facetData) {
    const display = document.getElementById('dev-facet-display');
    const valueEl = document.getElementById('dev-facet-value');

    if (!display || !valueEl) return;

    if (!facetName) {
      // All-facet mode
      display.classList.remove('has-facet');
      valueEl.innerHTML = `
        <strong class="dev-facet-all">All Facets</strong>
        <small>all-facet</small>
      `;
      return;
    }

    // Use provided facetData or fallback to window.facetsData
    if (!facetData) {
      facetData = window.facetsData?.find(f => f.name === facetName);
    }

    display.classList.add('has-facet');

    if (facetData) {
      valueEl.innerHTML = `
        ${facetData.emoji} ${facetData.title}
        <small>specific</small>
      `;
    } else {
      valueEl.innerHTML = `
        ${facetName}
        <small>specific</small>
      `;
    }
  }
})();
</script>
